<!DOCTYPE HTML>
<html lang="en" class="sidebar-visible no-js light">
    <head>
        <!-- Book generated using mdBook -->
        <meta charset="UTF-8">
        <title>webxdc</title>
        <meta name="robots" content="noindex" />


        <!-- Custom HTML head -->
        
        <meta content="text/html; charset=utf-8" http-equiv="Content-Type">
        <meta name="description" content="">
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <meta name="theme-color" content="#ffffff" />

        <link rel="icon" href="favicon.svg">
        <link rel="shortcut icon" href="favicon.png">
        <link rel="stylesheet" href="css/variables.css">
        <link rel="stylesheet" href="css/general.css">
        <link rel="stylesheet" href="css/chrome.css">
        <link rel="stylesheet" href="css/print.css" media="print">

        <!-- Fonts -->
        <link rel="stylesheet" href="FontAwesome/css/font-awesome.css">
        <link rel="stylesheet" href="fonts/fonts.css">

        <!-- Highlight.js Stylesheets -->
        <link rel="stylesheet" href="highlight.css">
        <link rel="stylesheet" href="tomorrow-night.css">
        <link rel="stylesheet" href="ayu-highlight.css">

        <!-- Custom theme stylesheets -->

    </head>
    <body>
        <!-- Provide site root to javascript -->
        <script type="text/javascript">
            var path_to_root = "";
            var default_theme = window.matchMedia("(prefers-color-scheme: dark)").matches ? "navy" : "light";
        </script>

        <!-- Work around some values being stored in localStorage wrapped in quotes -->
        <script type="text/javascript">
            try {
                var theme = localStorage.getItem('mdbook-theme');
                var sidebar = localStorage.getItem('mdbook-sidebar');

                if (theme.startsWith('"') && theme.endsWith('"')) {
                    localStorage.setItem('mdbook-theme', theme.slice(1, theme.length - 1));
                }

                if (sidebar.startsWith('"') && sidebar.endsWith('"')) {
                    localStorage.setItem('mdbook-sidebar', sidebar.slice(1, sidebar.length - 1));
                }
            } catch (e) { }
        </script>

        <!-- Set the theme before any content is loaded, prevents flash -->
        <script type="text/javascript">
            var theme;
            try { theme = localStorage.getItem('mdbook-theme'); } catch(e) { }
            if (theme === null || theme === undefined) { theme = default_theme; }
            var html = document.querySelector('html');
            html.classList.remove('no-js')
            html.classList.remove('light')
            html.classList.add(theme);
            html.classList.add('js');
        </script>

        <!-- Hide / unhide sidebar before it is displayed -->
        <script type="text/javascript">
            var html = document.querySelector('html');
            var sidebar = 'hidden';
            if (document.body.clientWidth >= 1080) {
                try { sidebar = localStorage.getItem('mdbook-sidebar'); } catch(e) { }
                sidebar = sidebar || 'visible';
            }
            html.classList.remove('sidebar-visible');
            html.classList.add("sidebar-" + sidebar);
        </script>

        <nav id="sidebar" class="sidebar" aria-label="Table of contents">
            <div class="sidebar-scrollbox">
                <ol class="chapter"><li class="chapter-item expanded "><a href="01_what_is_webxdc.html"><strong aria-hidden="true">1.</strong> What is webxdc?</a></li><li class="chapter-item expanded "><a href="02_get_started.html"><strong aria-hidden="true">2.</strong> Get started</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="02_01_chat_example.html"><strong aria-hidden="true">2.1.</strong> Chat Example</a></li><li class="chapter-item expanded "><a href="02_02_dev_tool.html"><strong aria-hidden="true">2.2.</strong> Developing with the Webxdc Development Tool</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="02_02_01_dev_tool_safari.html"><strong aria-hidden="true">2.2.1.</strong> Developing in Safari</a></li><li class="chapter-item expanded "><a href="02_02_02_dev_tool_android.html"><strong aria-hidden="true">2.2.2.</strong> Developing on Android</a></li></ol></li></ol></li><li class="chapter-item expanded "><a href="03_api_reference.html"><strong aria-hidden="true">3.</strong> API Reference</a></li><li class="chapter-item expanded "><a href="04_cookbook.html"><strong aria-hidden="true">4.</strong> Webxdc Cookbook</a></li><li class="chapter-item expanded "><a href="05_tips_and_tricks.html"><strong aria-hidden="true">5.</strong> Tips & Tricks</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="05_01_babel.html"><strong aria-hidden="true">5.1.</strong> Transpile newer Javascript with Babel.js</a></li><li class="chapter-item expanded "><a href="05_02_typescript.html"><strong aria-hidden="true">5.2.</strong> Typescript support</a></li><li class="chapter-item expanded "><a href="05_03_debugging_in_deltachat.html"><strong aria-hidden="true">5.3.</strong> Debugging inside Deltachat</a></li><li class="chapter-item expanded "><a href="05_03b_debugging_with_eruda.html"><strong aria-hidden="true">5.4.</strong> Debugging with eruda.js</a></li><li class="chapter-item expanded "><a href="05_04_optimize_icon.html"><strong aria-hidden="true">5.5.</strong> Optimizing your Icon</a></li><li class="chapter-item expanded "><a href="05_05_common_problems.html"><strong aria-hidden="true">5.6.</strong> Troubleshooting</a></li></ol></li><li class="chapter-item expanded "><a href="06_example_projects.html"><strong aria-hidden="true">6.</strong> Example Projects</a></li><li class="chapter-item expanded "><a href="07_community.html"><strong aria-hidden="true">7.</strong> Community</a></li><li class="chapter-item expanded affix "><li class="part-title">Other</li><li class="chapter-item expanded "><a href="08_extra_ui_implementation.html"><strong aria-hidden="true">8.</strong> UI Implementation instructions</a></li></ol>
            </div>
            <div id="sidebar-resize-handle" class="sidebar-resize-handle"></div>
        </nav>

        <div id="page-wrapper" class="page-wrapper">

            <div class="page">
                                <div id="menu-bar-hover-placeholder"></div>
                <div id="menu-bar" class="menu-bar sticky bordered">
                    <div class="left-buttons">
                        <button id="sidebar-toggle" class="icon-button" type="button" title="Toggle Table of Contents" aria-label="Toggle Table of Contents" aria-controls="sidebar">
                            <i class="fa fa-bars"></i>
                        </button>
                        <button id="theme-toggle" class="icon-button" type="button" title="Change theme" aria-label="Change theme" aria-haspopup="true" aria-expanded="false" aria-controls="theme-list">
                            <i class="fa fa-paint-brush"></i>
                        </button>
                        <ul id="theme-list" class="theme-popup" aria-label="Themes" role="menu">
                            <li role="none"><button role="menuitem" class="theme" id="light">Light (default)</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="rust">Rust</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="coal">Coal</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="navy">Navy</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="ayu">Ayu</button></li>
                        </ul>
                        <button id="search-toggle" class="icon-button" type="button" title="Search. (Shortkey: s)" aria-label="Toggle Searchbar" aria-expanded="false" aria-keyshortcuts="S" aria-controls="searchbar">
                            <i class="fa fa-search"></i>
                        </button>
                    </div>

                    <h1 class="menu-title">webxdc</h1>

                    <div class="right-buttons">
                        <a href="print.html" title="Print this book" aria-label="Print this book">
                            <i id="print-button" class="fa fa-print"></i>
                        </a>
                        <a href="https://github.com/deltachat/webxdc_docs" title="Git repository" aria-label="Git repository">
                            <i id="git-repository-button" class="fa fa-github"></i>
                        </a>

                    </div>
                </div>

                <div id="search-wrapper" class="hidden">
                    <form id="searchbar-outer" class="searchbar-outer">
                        <input type="search" id="searchbar" name="searchbar" placeholder="Search this book ..." aria-controls="searchresults-outer" aria-describedby="searchresults-header">
                    </form>
                    <div id="searchresults-outer" class="searchresults-outer hidden">
                        <div id="searchresults-header" class="searchresults-header"></div>
                        <ul id="searchresults">
                        </ul>
                    </div>
                </div>

                <!-- Apply ARIA attributes after the sidebar and the sidebar toggle button are added to the DOM -->
                <script type="text/javascript">
                    document.getElementById('sidebar-toggle').setAttribute('aria-expanded', sidebar === 'visible');
                    document.getElementById('sidebar').setAttribute('aria-hidden', sidebar !== 'visible');
                    Array.from(document.querySelectorAll('#sidebar a')).forEach(function(link) {
                        link.setAttribute('tabIndex', sidebar === 'visible' ? 0 : -1);
                    });
                </script>

                <div id="content" class="content">
                    <main>
                        <h1 id="what-is-webxdc"><a class="header" href="#what-is-webxdc">What is webxdc?</a></h1>
<h2 id="what-kind-of-interactive-content-can-be-created-with-this"><a class="header" href="#what-kind-of-interactive-content-can-be-created-with-this">What kind of interactive content can be created with this?</a></h2>
<p>Some ideas of what you can already create with webxdc.</p>
<ul>
<li>Games
<ul>
<li>Singleplayer games with a shared highscore</li>
<li>Multiplayer turn-based games (like tictactoe or chess)</li>
</ul>
</li>
<li>Productivity
<ul>
<li>Collaborative Document editors</li>
<li>Polls</li>
</ul>
</li>
</ul>
<div style="break-before: page; page-break-before: always;"></div><h1 id="get-started"><a class="header" href="#get-started">Get started</a></h1>
<p>First, you need to add the following script import to your <code>index.html</code>:</p>
<pre><code class="language-html">&lt;script src=&quot;webxdc.js&quot;&gt;&lt;/script&gt;
</code></pre>
<p>This loads the platform specific <code>webxdc.js</code> which wraps the platform's internal calls to provide the same interface on all platforms.</p>
<p>There are 3 base cases you should handle in your code:</p>
<table><thead><tr><th>case</th><th>what needs to be done</th></tr></thead><tbody>
<tr><td>webxdc was just (re)started</td><td>make sure the handler set with <code>setUpdateListener()</code> can use the previous state updates to process the current state</td></tr>
<tr><td>state update arrives</td><td>define a handler for incoming state updates with <code>setUpdateListener()</code></td></tr>
<tr><td>you want to send a new state update</td><td>send state updates with <code>sendUpdate()</code></td></tr>
</tbody></table>
<blockquote>
<p>You might find premade code snippet for what you need in our <a href="./04_cookbook.html">cookbook</a> section, if you just want to add common things like a scoreboard to your game.</p>
</blockquote>
<blockquote>
<p>For testing and developing locally outside of deltachat you can use our <a href="./02_02_dev_tool.html">webxdc dev tool</a></p>
</blockquote>
<blockquote>
<p>If you want to use Typescript or just completion in your IDE learn how to set that up <a href="./05_02_typescript.html">here</a>.</p>
</blockquote>
<p>Also remember that the older devices might not have all new JavaScript features,
so it is recommended to transpile your code down to an older JS version (see <a href="./05_01_babel.html">Transpile newer Javascript with Babel.js</a>).</p>
<h2 id="packaging"><a class="header" href="#packaging">Packaging</a></h2>
<blockquote>
<ul>
<li>a <strong>Webxdc file</strong> is a <strong>ZIP</strong>-file with the extension <code>.xdc</code>.</li>
<li>The zip file needs to contain all files that your <code>index.html</code> needs (scripts, css-stylesheets, images, fonts, etc.).</li>
<li>The resulting zipfile should be smaller than <code>100</code>KB (kilobytes), we might raise this limit in the future.</li>
</ul>
</blockquote>
<p>So put the following into your zip file:</p>
<ul>
<li>your <code>index.html</code> file and all resources it needs</li>
<li>an <code>icon.png</code> or <code>icon.jpg</code> (<a href="./03_api_reference.html#app-icon">info about required format</a>)</li>
<li>a <code>manifest.toml</code> file with your meta data. (<a href="./03_api_reference.html#manifest-file">documentation</a>)</li>
</ul>
<p>manifest.toml:</p>
<pre><code class="language-toml">name = &quot;My Webxdc Name&quot;
</code></pre>
<p>Then rename your file's extention from <code>.zip</code> to <code>.xdc</code>.
Now you can send it into a deltachat chat and start using it right away, there is no certification or other bureaucracy required ;)</p>
<div style="break-before: page; page-break-before: always;"></div><h1 id="chat-example"><a class="header" href="#chat-example">Chat Example</a></h1>
<p>TODO - step by step coding the chat example and explaining each webxdc specific step</p>
<div style="break-before: page; page-break-before: always;"></div><h1 id="using-the-webxdc-development-tool"><a class="header" href="#using-the-webxdc-development-tool">Using the Webxdc Development Tool</a></h1>
<p>This is a little tool to make creation of webxdc content easier.
It is found on <a href="https://github.com/deltachat/webxdc-dev">https://github.com/deltachat/webxdc-dev</a>.</p>
<p>Advantages:</p>
<ul>
<li>Super easy to get started.</li>
<li>No server or installation required.</li>
<li>You don't need your DeltaChat app for testing. (you save the packaging step)</li>
</ul>
<h2 id="contents"><a class="header" href="#contents">Contents</a></h2>
<p>The devtool has 2 parts:</p>
<ul>
<li><code>webxdc.js</code> which acts as simulator</li>
<li><code>create-xdc.sh</code>, a script that packs your webxdc into a <a href="./03_api_reference.html#zip-format"><code>.xdc</code></a> file for you</li>
</ul>
<h2 id="use-the-simulator"><a class="header" href="#use-the-simulator">Use the Simulator</a></h2>
<p>For developing your webxdc, just copy the <a href="https://github.com/deltachat/webxdc-dev/blob/master/webxdc.js"><code>webxdc.js</code> from the repo</a> beside your <code>index.html</code> and you are ready to go.</p>
<blockquote>
<p>Platform Quirks:</p>
<ul>
<li>On Safari you need to <a href="./02_02_01_dev_tool_safari.html">disable local file restrictions</a>.</li>
<li>On Android you might need to <a href="./02_02_02_dev_tool_android.html">serve it using a local http server</a>.</li>
</ul>
</blockquote>
<p>Click on <code>Add Peer</code> to add another instance.</p>
<p>Now you can test your webxdc while developing it with a simple reload, instead of repacking it and testing it inside of deltachat, also you don't need deltachat to develop webxdc content using this method.</p>
<blockquote>
<p><code>Clear Storage</code> resets the simulator (removes all previous state updates).</p>
</blockquote>
<h2 id="use-it-as-a-template-for-your-webxdc-project"><a class="header" href="#use-it-as-a-template-for-your-webxdc-project">Use it as a template for your webxdc project</a></h2>
<p>(fork and) clone <code>https://github.com/deltachat/webxdc-dev</code></p>
<p>modify <code>index.html</code> to as you like, then open <code>index.html</code> in your webbrowser to try out your webxdc.</p>
<div style="break-before: page; page-break-before: always;"></div><h1 id="developing-in-safari"><a class="header" href="#developing-in-safari">Developing in Safari</a></h1>
<p>To use the devtool in safari you need to disable the local file restrictions
under <code>Develop</code> -&gt; <code>Disable Local File Restrictions</code>:</p>
<p>
<img
src="images/dev_tool_settings_safari.png"
alt="'Disable Local File Restrictions' entry in the 'Develop' menu in safari"
style="max-height:40vh"
/>
</p>
<p>After doing this you can use the dev tool simulator.</p>
<p>Make sure to reload (<code>Cmd + R</code>) all simulator tabs/windows to apply this setting.</p>
<p>Without this option <code>Add Peer</code> seems to work (it opens a new instance), but <strong>the instances will not be able to communicate</strong>.</p>
<div style="break-before: page; page-break-before: always;"></div><h1 id="developing-on-android"><a class="header" href="#developing-on-android">Developing on Android</a></h1>
<p>TODO - turn notes into a nice guide</p>
<ul>
<li>
<p>install Termux</p>
</li>
<li>
<p>install python &amp; git in termux (or is it preinstalled??)</p>
</li>
<li>
<p>git clone the devtool repo or your fork of it</p>
</li>
<li>
<p>use <code>python -m http.server</code> (TODO check complete syntax) to serve it for development and use nano / vim</p>
</li>
<li>
<p>when your done use the packaging script</p>
</li>
<li>
<p>and then copy the file to a location from where you can access and send it via deltachat.</p>
</li>
<li>
<p>pro tip: you can create symbolic link to a folder in the external storage</p>
</li>
</ul>
<!-- there are some gui apps on fdroid we could try:
IDE: https://f-droid.org/packages/com.blacksquircle.ui/
HTTP server: https://f-droid.org/packages/com.example.flutter_http_server/
 --><div style="break-before: page; page-break-before: always;"></div><h2 id="api-reference"><a class="header" href="#api-reference">API Reference</a></h2>
<h3 id="javascript-interface"><a class="header" href="#javascript-interface">JavaScript Interface</a></h3>
<p>TODO, please refer to <a href="https://github.com/deltachat/deltachat-core-rust/blob/master/draft/webxdc-dev-reference.md">https://github.com/deltachat/deltachat-core-rust/blob/master/draft/webxdc-dev-reference.md</a> in the meantime.</p>
<p>(could we generate the markdown from the TS definion file? - one less place to update docs and so on?)</p>
<h3 id="manifest-file"><a class="header" href="#manifest-file">Manifest file <a id="manifest"></a></a></h3>
<p>If the ZIP-file contains a manifest.toml in its root directory, some basic information are read and used from there.</p>
<p>the manifest.toml has the following format</p>
<pre><code class="language-toml">name = &quot;My Webxdc Name&quot;
</code></pre>
<ul>
<li><code>name</code> - The name of the webxdc. If no name is set or if there is no manifest, the filename is used as the name.</li>
</ul>
<h3 id="webxdc-icon"><a class="header" href="#webxdc-icon">Webxdc Icon <a id="icon"></a></a></h3>
<p>If the ZIP-root contains an <code>icon.png</code> or <code>icon.jpg</code>, these files are used as the icon shown in deltachat. The icon should be a square at reasonable width/height; round corners etc. will be added by the implementations as needed. If no icon is set, a default icon will be used.</p>
<h3 id="zip-file-format-xdc"><a class="header" href="#zip-file-format-xdc">Zip File format <code>.xdc</code> <a id="zip-format"></a></a></h3>
<p>Just a zip file with the <code>.zip</code> extension renamed to <code>.xdc</code>.
Contents:</p>
<ul>
<li><code>index.html</code>: entry point</li>
<li>(optional) <code>manifest.toml</code>: <a href="03_api_reference.html#manifest">configuration file, specifying properties</a></li>
<li>(optional) <code>icon.png</code> or <code>icon.jpg</code>: the <a href="03_api_reference.html#icon">icon of the package</a></li>
</ul>
<blockquote>
<p>The ZIP-file can only use the compression methods <code>Deflate</code> and <code>Store</code>. Other compression methods are not supported at this time.</p>
</blockquote>
<div style="break-before: page; page-break-before: always;"></div><h1 id="webxdc-cookbook"><a class="header" href="#webxdc-cookbook">Webxdc Cookbook</a></h1>
<!-- this section is inpired by https://rust-lang-nursery.github.io/rust-cookbook/ -->
<p>In this chapter you can find small code snippets (recipes) that help you implement some commonly used features, such as scoreboards for adding a highscore to your game.</p>
<p>Feel free to contribute recipies that you find useful on <a href="https://github.com/deltachat/webxdc_docs">github</a>.</p>
<p>(As this section is being written, you might find more examples in the <a href="https://github.com/deltachat/deltachat-core-rust/blob/master/draft/webxdc-dev-reference.md">core library</a>).</p>
<div style="break-before: page; page-break-before: always;"></div><h1 id="tips--tricks"><a class="header" href="#tips--tricks">Tips &amp; Tricks</a></h1>
<ul>
<li><a href="./05_01_babel.html">Transpile newer Javascript with Babel.js</a></li>
<li><a href="./05_02_typescript.html">Typescript support</a></li>
<li><a href="./05_03_debugging_in_deltachat.html">Debugging inside Deltachat</a></li>
<li><a href="./05_03b_debugging_with_eruda.html">Debugging with eruda.js</a></li>
<li><a href="./05_04_optimize_icon.html">Optimizing your Icon</a></li>
<li><a href="./05_05_common_problems.html">Troubleshooting</a></li>
</ul>
<div style="break-before: page; page-break-before: always;"></div><h1 id="transpile-newer-javascript-with-babeljs"><a class="header" href="#transpile-newer-javascript-with-babeljs">Transpile newer Javascript with Babel.js</a></h1>
<p>Older devices might not have the newest javascript features/syntax in their webview, you may want to transpile your code down to an older js version eg. with <a href="https://babeljs.io">https://babeljs.io</a></p>
<p>TODO guide, TODO find out what the oldest browser/webview version is that we support.</p>
<p>Targets:</p>
<ul>
<li>Desktop (electron -&gt; is chrome 91)</li>
<li>iOS (iOS 11 -&gt; webkit 604.1.38)</li>
<li>android (android 5 -&gt; the webview system component can be updated by the user: <a href="https://play.google.com/store/apps/details?id=com.google.android.webview">https://play.google.com/store/apps/details?id=com.google.android.webview</a>)</li>
</ul>
<p>If you want to use a newer API make sure to check on <a href="https://caniuse.com">https://caniuse.com</a>. If you just want to use newer JavaScript syntax, babel.js is the right tool for you - it translates new JS into older JS, that can be interpreted.</p>
<div style="break-before: page; page-break-before: always;"></div><h1 id="typescript-support"><a class="header" href="#typescript-support">Typescript support</a></h1>
<p>How to get autocompletion for window.webxdc api in you IDE via typescript.</p>
<h2 id="get-the-typescript-definitions"><a class="header" href="#get-the-typescript-definitions">Get the typescript definitions</a></h2>
<p>Just copy <a href="https://github.com/deltachat/webxdc_docs/blob/master/webxdc.d.ts"><code>webxdc.d.ts</code></a> into your source dir:</p>
<pre><code class="language-typescript">type SendingStatusUpdate&lt;T&gt; = {
  /** the payload, deserialized json:
   * any javascript primitive, array or object. */
  payload: T;
  /** optional, short, informational message that will be added to the chat,
   * eg. &quot;Alice voted&quot; or &quot;Bob scored 123 in MyGame&quot;;
   * usually only one line of text is shown,
   * use this option sparingly to not spam the chat. */
  info?: string;
  /** optional, short text, shown beside the icon;
   * it is recommended to use some aggregated value,
   * eg. &quot;8 votes&quot;, &quot;Highscore: 123&quot; */
  summary?: string;
};

type ReceivedStatusUpdate&lt;T&gt; = {
  /** the payload, deserialized json */
  payload: T;
  /** the serial number of this update. Serials are larger than 0 and newer serials have higher numbers */
  serial: number;
  /** the maximum serial currently known */
  max_serial: number;
  /** optional, short, informational message. */
  info?: string;
  /** optional, short text, shown beside the webxdc's icon. */
  summary?: string;
};

interface Webxdc&lt;T&gt; {
  /** Returns the peer's own address.
   *  This is esp. useful if you want to differ between different peers - just send the address along with the payload,
   *  and, if needed, compare the payload addresses against selfAddr() later on. */
  selfAddr: string;
  /** Returns the peer's own name. This is name chosen by the user in their settings, if there is nothing set, that defaults to the peer's address. */
  selfName: string;
  /**
   * set a listener for new status updates.
   * The &quot;serial&quot; specifies the last serial that you know about (defaults to 0).
   * Note that own status updates, that you send with {@link sendUpdate}, also trigger this method
   * @returns promise that resolves when the listener has processed all the update messages known at the time when `setUpdateListener` was called.
   * */
  setUpdateListener(cb: (statusUpdate: ReceivedStatusUpdate&lt;T&gt;) =&gt; void, serial?: number): Promise&lt;void&gt;;
  /**
   * WARNING! This function is deprecated, see setUpdateListener().
   */
  getAllUpdates(): Promise&lt;ReceivedStatusUpdate&lt;T&gt;[]&gt;;
  /**
   * Webxdcs are usually shared in a chat and run independently on each peer. To get a shared status, the peers use sendUpdate() to send updates to each other.
   * @param update status update to send
   * @param description short, human-readable description what this update is about. this is shown eg. as a fallback text in an email program.
   */
  sendUpdate(update: SendingStatusUpdate&lt;T&gt;, description: string): void;
}

////////// ANCHOR: global
declare global {
  interface Window {
    webxdc: Webxdc&lt;any&gt;;
  }
}
////////// ANCHOR_END: global

export { SendingStatusUpdate, ReceivedStatusUpdate, Webxdc };
</code></pre>
<p>you can find it also on <a href="https://github.com/deltachat/webxdc_docs/blob/master/webxdc.d.ts">https://github.com/deltachat/webxdc_docs/blob/master/webxdc.d.ts</a> or just copy the code block above.</p>
<blockquote>
<p>In the future this might become an @types npm module, but for now it is what it is: <em>a simple file copy with <strong>no</strong> automatic updates</em>.</p>
</blockquote>
<h2 id="using-the-types"><a class="header" href="#using-the-types">Using the types</a></h2>
<p>for using the types you need to import the file.</p>
<h3 id="using-in-typescript"><a class="header" href="#using-in-typescript">Using in typescript</a></h3>
<pre><code class="language-tyspescript">import type { Webxdc } from './webxdc.d.ts'
</code></pre>
<h3 id="using-in-javascript"><a class="header" href="#using-in-javascript">Using in Javascript</a></h3>
<pre><code class="language-javascript">/**
 * @typedef {import('./webxdc').Webxdc} Webxdc
 */
</code></pre>
<p>This works in vscode nicely together with the <code>//@ts-check</code> comment on top of your source file.</p>
<p>If you want you can also type your own functions using <a href="https://jsdoc.app/">JSDoc comments</a>.</p>
<blockquote>
<p>If you don't use vscode you can still make use of the type checking with the typescript compiler:</p>
<pre><code class="language-sh">npm i -g typescript # -g stands for global installation
tsc --noEmit --allowJs --lib es2015,dom *.js
</code></pre>
</blockquote>
<h2 id="own-payload-type"><a class="header" href="#own-payload-type">Own Payload type</a></h2>
<p>If you have a type for your state update <strong>payloads</strong>, replace the <code>any</code> in <code>Webxdc&lt;any&gt;</code> with your own payload type:</p>
<pre><code class="language-typescript">declare global {
  interface Window {
    webxdc: Webxdc&lt;any&gt;;
  }
}
</code></pre>
<div style="break-before: page; page-break-before: always;"></div><h1 id="debugging-inside-deltachat"><a class="header" href="#debugging-inside-deltachat">Debugging inside Deltachat</a></h1>
<h2 id="debug-your-webxdc-content-in-android-via-chrome-devtools"><a class="header" href="#debug-your-webxdc-content-in-android-via-chrome-devtools">Debug your webxdc content in Android via Chrome DevTools</a></h2>
<ol>
<li>enable webView debugging in delta chat settings <code>Settings</code> &gt; <code>Advanced</code> &gt; <code>Developer Mode</code>: <img alt="image of andvanced screen" src="images/android_remote_debug_enable.png" style="max-height:40vh" /></li>
<li>enable developer mode and ADB debugging on your device <em>(go to system settings, device info, spam click on build number until there is a toast telling you that you are now a &quot;Developer&quot;, then go into the developer menu that just appeared and enable &quot;ADB debugging&quot;, see also <a href="https://developer.android.com/studio/command-line/adb#Enabling">android docs: Enable ADB debugging on your device</a>).</em></li>
<li>connect your device via USB to your computer</li>
<li>open chromium (or google chrome) and go to <code>chrome://inspect/#devices</code></li>
<li>start your webxdc that you want to debug</li>
<li>click on <code>inspect</code>:</li>
</ol>
<p>
<img
src="images/android_remote_debug_list.png"
alt="screenshot of chrome dev tools device list"
style="max-height:40vh"
/>
</p>
<table><thead><tr><th>Inpect HTML</th><th>Javascript Console</th></tr></thead><tbody>
<tr><td><img src="images/android_remote_debug_inspector.png" alt="dev tools inpector" /></td><td><img src="images/android_remote_debug_console.png" alt="dev tools js console" /></td></tr>
</tbody></table>
<blockquote>
<p>Make sure to <strong>disable adb debugging again</strong> after you are done with debugging!</p>
</blockquote>
<h2 id="debug-your-webxdc-content-in-deltachat-desktop"><a class="header" href="#debug-your-webxdc-content-in-deltachat-desktop">Debug your webxdc content in DeltaChat Desktop</a></h2>
<p>Start the webxdc you want to debug and press <code>F12</code> to open the developer tools:</p>
<p>
<img
src="images/desktop_debug_open.png"
alt="screenshot of desktop webxdc window with devtool"
style="max-height:40vh"
/>
</p>
<p>A bit small isn't it? fix it either by resizing the window's <strong>width</strong> or <strong>undock</strong> the developer tools:</p>
<p>
<img
src="images/desktop_debug_undock.png"
alt="undock devtools"
style="max-height:40vh"
/>
</p>
<p>
<img
src="images/desktop_debug_extra_window.png"
alt="undock devtools"
style="max-height:40vh"
/>
</p>
<h2 id="debug-your-webxdc-content-on-the-ios-deltachat"><a class="header" href="#debug-your-webxdc-content-on-the-ios-deltachat">Debug your webxdc content on the iOS DeltaChat</a></h2>
<p>This is only possible in debug builds of deltachat-ios, not in the released App Store or TestFlight version, so please use <a href="05_03b_debugging_with_eruda.html">debugging with eruda.js</a> instead.</p>
<div style="break-before: page; page-break-before: always;"></div><h1 id="debugging-with-erudajs"><a class="header" href="#debugging-with-erudajs">Debugging with eruda.js</a></h1>
<p>When you can not use <a href="05_03_debugging_in_deltachat.html">debugging inside Deltachat</a>, either because you have no computer to connect to or are on iOS, you can use <a href="https://github.com/liriliri/eruda">eruda.js</a> as an alternative to the native dev tools.</p>
<h2 id="installing-eruda"><a class="header" href="#installing-eruda">Installing eruda</a></h2>
<p>download <code>eruda.min.js</code> from [TODO link], copy it next to your <code>index.html</code> and then add this snippet into the head section of your index.html, before all other scripts:</p>
<pre><code class="language-html">&lt;script src=&quot;eruda.min.js&quot;&gt;&lt;/script&gt;
&lt;script&gt;
  eruda.init();
&lt;/script&gt;
</code></pre>
<h2 id="using-eruda"><a class="header" href="#using-eruda">Using eruda</a></h2>
<p>[TODO small introduction, how to open it (click on the button)]</p>
<div style="break-before: page; page-break-before: always;"></div><h1 id="optimizing-your-icon"><a class="header" href="#optimizing-your-icon">Optimizing your Icon</a></h1>
<p>There are several things you can do to shrink down the size of your icon:</p>
<ul>
<li>save without thumbnail image (in gimp it can be done in the export dialog)</li>
<li>shrink the image resolution (<code>256px</code> are enough, in some cases <code>128px</code> or even lower like <code>64px</code> can sufice)</li>
<li>change your PNG colors from <code>RGB</code> to <code>Indexed</code> (in gimp <code>Image</code> -&gt; <code>Mode</code> -&gt; <code>Indexed</code>, see <a href="https://docs.gimp.org/en/gimp-image-convert-indexed.html">https://docs.gimp.org/en/gimp-image-convert-indexed.html</a>)</li>
</ul>
<blockquote>
<p>For <code>png</code> you can also use the <code>oxipng</code> tool (<a href="https://github.com/shssoichiro/oxipng">https://github.com/shssoichiro/oxipng</a>), which automagically optimizes your icon's file size without quality loss:</p>
<pre><code>oxipng icon.png -s -o max
</code></pre>
<p>If you have png files in your project, you should also do this them to safe even more bytes.</p>
<p>Noteworthy parameters:</p>
<ul>
<li><code>--pretend</code> only calculates gains</li>
<li><code>-Z</code> even more compression, but takes longer</li>
<li>for more info see <code>oxipng --help</code></li>
</ul>
</blockquote>
<div style="break-before: page; page-break-before: always;"></div><h1 id="troubleshooting"><a class="header" href="#troubleshooting">Troubleshooting</a></h1>
<h2 id="i-cannot-share-variables-on-ios-between-scripts"><a class="header" href="#i-cannot-share-variables-on-ios-between-scripts">I cannot share variables on iOS between scripts!</a></h2>
<p>Your code:</p>
<p><code>a.js</code></p>
<pre><code class="language-js">const CONFIG = { dificulty: &quot;hard&quot;, hasCoins: true };
</code></pre>
<p><code>b.js</code></p>
<pre><code class="language-js">if (CONFIG.dificulty == &quot;hard&quot;) {
  /** make the game harder **/
}
</code></pre>
<p><code>index.html</code></p>
<pre><code class="language-html">&lt;html&gt;
  &lt;head&gt;
    &lt;!-- ... --&gt;
  &lt;/head&gt;
  &lt;body&gt;
    &lt;!-- ... --&gt;
    &lt;script src=&quot;a.js&quot;&gt;&lt;/script&gt;
    &lt;script src=&quot;b.js&quot;&gt;&lt;/script&gt;
  &lt;/body&gt;
&lt;/html&gt;
</code></pre>
<p>Basically you get many errors in your JS console like this:</p>
<pre><code>Can't find variable: CONFIG
</code></pre>
<p>There are a few ways to solve this:</p>
<ul>
<li>use a bundle to bundle all your JS to one file (some bundlers: parcel, webpack, esbuild)</li>
<li>use esm modules (see <a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Guide/Modules">https://developer.mozilla.org/en-US/docs/Web/JavaScript/Guide/Modules</a>)</li>
<li>define your variables as inline script in your HTML file. (inline script means that the script is in the HTML file between the <code>&lt;script&gt;</code> tags: <code>&lt;script&gt;my code&lt;/script&gt;</code>)</li>
<li>append your global variables to the window object: <code>window.myVar = 1;</code> and use them like <code>console.log(window.myVar)</code></li>
</ul>
<div style="break-before: page; page-break-before: always;"></div><h1 id="example-projects"><a class="header" href="#example-projects">Example Projects</a></h1>
<p>Here you can find some example projects. If you have a project that you want to share feel free to make a pull request to add it here on <a href="https://github.com/deltachat/webxdc_docs">github</a>. (Or just click on the edit icon in the top right corner, it will take you directly to editing this page)</p>
<h2 id="productivity"><a class="header" href="#productivity">Productivity</a></h2>
<ul>
<li>Poll: <a href="https://github.com/r10s/webxdc-poll">https://github.com/r10s/webxdc-poll</a></li>
<li>Draw: <a href="https://github.com/adbenitez/draw.xdc">https://github.com/adbenitez/draw.xdc</a></li>
</ul>
<h2 id="games"><a class="header" href="#games">Games</a></h2>
<ul>
<li>TicTacToe: <a href="https://github.com/Simon-Laux/tictactoe.xdc">https://github.com/Simon-Laux/tictactoe.xdc</a></li>
<li>2048: <a href="https://github.com/adbenitez/2048.xdc">https://github.com/adbenitez/2048.xdc</a></li>
<li>Chess Board: <a href="https://github.com/adbenitez/ChessBoard.xdc">https://github.com/adbenitez/ChessBoard.xdc</a></li>
<li>StackUp: <a href="https://github.com/adbenitez/StackUp.xdc">https://github.com/adbenitez/StackUp.xdc</a></li>
<li>Othello: <a href="https://github.com/adbenitez/Othello.xdc">https://github.com/adbenitez/Othello.xdc</a></li>
</ul>
<p>Even more examples can be found searching for the <a href="https://github.com/topics/webxdc"><code>#webxdc</code> Topic on GitHub</a>.</p>
<div style="break-before: page; page-break-before: always;"></div><h1 id="community"><a class="header" href="#community">Community</a></h1>
<p>You can ask questions and showcase your projects on the DeltaChat forum under the <code>webxdc</code> category: <a href="07_community.html#TODO">TODO link</a></p>
<p>You can login into the forum via DeltaChat, Github or by creating a normal account there.</p>
<div style="break-before: page; page-break-before: always;"></div><h1 id="ui-implementation-instructions"><a class="header" href="#ui-implementation-instructions">UI Implementation instructions</a></h1>
<ul>
<li>Deny all forms of internet access</li>
<li>enable DOM storage (local storage, indexed db and co), but make sure it is scoped to each webxdc so they can not delete or modify the data of other webxdc content.</li>
<li>load resources over the <code>webxdc:</code> scheme and deny others (also, the UI should handle <code>webxdc:</code> internally) - can be also <code>https</code> if ui does not support the custom scheme properly.</li>
<li>implement fetching <code>webxdc.js</code> over that scheme, should give back a JavaScript file wrapping all native API's to the interface described above.</li>
<li>info messages -&gt; click on them should jump to their webxdc message</li>
</ul>

                    </main>

                    <nav class="nav-wrapper" aria-label="Page navigation">
                        <!-- Mobile navigation buttons -->


                        <div style="clear: both"></div>
                    </nav>
                </div>
            </div>

            <nav class="nav-wide-wrapper" aria-label="Page navigation">

            </nav>

        </div>




        <script type="text/javascript">
            window.playground_copyable = true;
        </script>


        <script src="elasticlunr.min.js" type="text/javascript" charset="utf-8"></script>
        <script src="mark.min.js" type="text/javascript" charset="utf-8"></script>
        <script src="searcher.js" type="text/javascript" charset="utf-8"></script>

        <script src="clipboard.min.js" type="text/javascript" charset="utf-8"></script>
        <script src="highlight.js" type="text/javascript" charset="utf-8"></script>
        <script src="book.js" type="text/javascript" charset="utf-8"></script>

        <!-- Custom JS scripts -->

        <script type="text/javascript">
        window.addEventListener('load', function() {
            window.setTimeout(window.print, 100);
        });
        </script>

    </body>
</html>
